const FormValidation={config:{showErrorsOnBlur:!0,showErrorsOnSubmit:!0,scrollToFirstError:!0},rules:{required:e=>""!==e.trim(),email:e=>Utils.validateEmail(e),cpf:e=>Utils.validateCPF(e),phone:e=>Utils.validatePhone(e),cep:e=>Utils.validateCEP(e),minLength:(e,t)=>e.length>=parseInt(t),maxLength:(e,t)=>e.length<=parseInt(t),minAge:(e,t)=>{const o=Utils.calculateAge(e);return o>=parseInt(t)},maxAge:(e,t)=>{const o=Utils.calculateAge(e);return o<=parseInt(t)},match:(e,t)=>e===t},messages:{required:"Este campo é obrigatório",email:"Por favor, insira um e-mail válido",cpf:"CPF inválido",phone:"Telefone inválido. Use o formato (11) 98765-4321",cep:"CEP inválido. Use o formato 12345-678",minLength:"Mínimo de {min} caracteres",maxLength:"Máximo de {max} caracteres",minAge:"Idade mínima: {minAge} anos",maxAge:"Idade máxima: {maxAge} anos",match:"Os campos não coincidem"},validateField:e=>{const t=e.value.trim(),o=document.getElementById(`${e.id}Error`);let a=!0,r="";if(e.classList.remove("error"),o&&(o.textContent=""),e.hasAttribute("required")&&!FormValidation.rules.required(t))a=!1,r=FormValidation.messages.required;else if("email"===e.type&&t&&!FormValidation.rules.email(t))a=!1,r=FormValidation.messages.email;else if("cpf"===e.id&&t&&!FormValidation.rules.cpf(t))a=!1,r=FormValidation.messages.cpf;else if("telefone"===e.id&&t&&!FormValidation.rules.phone(t))a=!1,r=FormValidation.messages.phone;else if("cep"===e.id&&t&&!FormValidation.rules.cep(t))a=!1,r=FormValidation.messages.cep;else if(e.hasAttribute("minlength")&&t.length>0){const o=parseInt(e.getAttribute("minlength"));FormValidation.rules.minLength(t,o)||(a=!1,r=FormValidation.messages.minLength.replace("{min}",o))}else if(e.hasAttribute("maxlength")&&t.length>0){const o=parseInt(e.getAttribute("maxlength"));FormValidation.rules.maxLength(t,o)||(a=!1,r=FormValidation.messages.maxLength.replace("{max}",o))}else if("date"===e.type&&"dataNascimento"===e.id&&t){const e=Utils.calculateAge(t);(e<14||e>100)&&(a=!1,r="Idade deve estar entre 14 e 100 anos")}else"checkbox"===e.type&&e.hasAttribute("required")&&!e.checked&&(a=!1,r="Você deve aceitar este termo");return a||(e.classList.add("error"),o&&(o.textContent=r)),a},validateForm:e=>{let t=!0;const o=e.querySelectorAll("input[required], select[required], textarea[required]");return o.forEach(e=>{FormValidation.validateField(e)||(t=!1)}),t},checkDataConsistency:e=>{const t=[];if(e.nomeCompleto){const o=e.nomeCompleto.trim().split(" ");o.length<2&&t.push({field:"nomeCompleto",message:"Sugestão: Inclua nome e sobrenome completos"})}if(e.dataNascimento&&e.areaInteresse){const o=Utils.calculateAge(e.dataNascimento);o<18&&"administrativo"===e.areaInteresse&&t.push({field:"areaInteresse",message:"Atenção: Área administrativa geralmente requer maioridade"})}return"2-4"===e.disponibilidade&&"profissionalizacao"===e.areaInteresse&&t.push({field:"disponibilidade",message:"Sugestão: Área de profissionalização requer mais horas semanais"}),e.motivacao&&e.motivacao.length<50&&t.push({field:"motivacao",message:"Sugestão: Detalhe melhor suas motivações (mínimo 50 caracteres)"}),t},showConsistencyWarnings:e=>{if(e.length>0){let t='<strong>Avisos de Preenchimento:</strong><ul style="margin: 10px 0; padding-left: 20px;">';e.forEach(e=>{t+=`<li>${e.message}</li>`}),t+="</ul><small>Você pode continuar, mas recomendamos revisar estes campos.</small>",Utils.showAlert(t,"warning")}},init:e=>{const t=document.getElementById(e);if(!t)return;const o=t.querySelectorAll("input, select, textarea"),a=t.querySelector("#cpf"),r=t.querySelector("#telefone"),s=t.querySelector("#cep");a&&a.addEventListener("input",e=>{e.target.value=Utils.formatCPF(e.target.value)}),r&&r.addEventListener("input",e=>{e.target.value=Utils.formatPhone(e.target.value)}),s&&(s.addEventListener("input",e=>{e.target.value=Utils.formatCEP(e.target.value)}),s.addEventListener("blur",async()=>{const e=s.value.replace(/\D/g,"");if(8===e.length)try{let o=Storage.getCachedCEP(e);o||(o=await Utils.fetchCEP(e),Storage.cacheCEP(e,o));const a=t.querySelector("#endereco"),r=t.querySelector("#cidade"),s=t.querySelector("#estado");a&&o.logradouro&&(a.value=o.logradouro),r&&(r.value=o.localidade),s&&(s.value=o.uf),Utils.showToast("CEP encontrado com sucesso!","success")}catch(e){Utils.showToast(e.message,"error")}})),o.forEach(e=>{e.addEventListener("blur",()=>{FormValidation.config.showErrorsOnBlur&&FormValidation.validateField(e)}),e.addEventListener("input",()=>{if(e.classList.contains("error")){e.classList.remove("error");const t=document.getElementById(`${e.id}Error`);t&&(t.textContent="")}})}),t.addEventListener("submit",e=>{e.preventDefault();const o=FormValidation.validateForm(t);if(o){const e=new FormData(t),o={};e.forEach((e,t)=>{o[t]=e});const a=FormValidation.checkDataConsistency(o);a.length>0?(FormValidation.showConsistencyWarnings(a),setTimeout(()=>{confirm("Foram detectados alguns avisos. Deseja revisar o formulário ou continuar mesmo assim?")&&FormValidation.submitForm(t,o)},500)):FormValidation.submitForm(t,o)}else{if(FormValidation.config.scrollToFirstError){const e=t.querySelector(".error");e&&(Utils.smoothScrollTo(e),e.focus())}Utils.showToast("Por favor, corrija os erros no formulário","error")}});const i=Utils.debounce(()=>{const o=new FormData(t),a={};o.forEach((e,t)=>{"termos"!==t&&"privacidade"!==t&&(a[t]=e)}),Object.keys(a).length>0&&(Storage.saveDraft(e,a),console.log("Rascunho salvo automaticamente"))},3e3);o.forEach(e=>{e.addEventListener("input",i)}),FormValidation.loadDraft(t,e)},submitForm:(e,t)=>{Storage.saveVolunteer(t),Storage.removeDraft(e.id),e.style.display="none";const o=document.getElementById("successMessage");o&&(o.style.display="block",Utils.smoothScrollTo(o)),Utils.showToast("Cadastro realizado com sucesso!","success"),console.log("Dados do formulário:",t)},loadDraft:(e,t)=>{const o=Storage.getDraft(t);if(o&&Object.keys(o.data).length>0){const a=confirm("Encontramos um rascunho salvo anteriormente. Deseja recuperá-lo?");a?(Object.keys(o.data).forEach(t=>{const a=e.querySelector(`[name="${t}"]`);a&&(a.value=o.data[t])}),Utils.showToast("Rascunho recuperado com sucesso!","success")):Storage.removeDraft(t)}},resetForm:e=>{const t=document.getElementById(e);if(t){t.reset();const o=t.querySelectorAll(".error");o.forEach(e=>e.classList.remove("error"));const a=t.querySelectorAll(".error-message");a.forEach(e=>e.textContent=""),Storage.removeDraft(e),Utils.showToast("Formulário limpo","info")}}};"undefined"!=typeof module&&module.exports&&(module.exports=FormValidation);